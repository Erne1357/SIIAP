{% extends 'auth_base.html' %}
{% block title %}SIIAP – Registro de Usuario{% endblock %}

{% block body_class %}register-body{% endblock %}
{% block main_class %}register-page{% endblock %}
{% block container_class %}register-container{% endblock %}
{% block bg_class %}register-container{% endblock %}

{% block styles %}
  {{ super() }}
  <link href="{{ url_for('static', filename='css/auth/register.css') }}?v={{ static_version }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="card">
  <div class="card-body">
    <h3 class="card-title text-center mb-3">Registro de Usuario</h3>
    <hr class="mx-3">
    <p class="text-center text-muted mb-4" style="font-size: 0.9rem;">
      Completa el formulario para crear tu cuenta. 
      <br>
      Todos los campos marcados con <span style="color:red">*</span> son obligatorios.
    </p>

    <form method="POST">
      <div class="row g-3 mb-3">
        <div class="col-md-4">
          <label for="first_name" class="form-label">Nombre <span style="color:red">*</span></label>
          <input type="text" class="form-control" id="first_name" name="first_name" required>
        </div>
        <div class="col-md-4">
          <label for="last_name" class="form-label">Apellido Paterno <span style="color:red">*</span></label>
          <input type="text" class="form-control" id="last_name" name="last_name" required>
        </div>
        <div class="col-md-4">
          <label for="mother_last_name" class="form-label">Apellido Materno</label>
          <input type="text" class="form-control" id="mother_last_name" name="mother_last_name">
        </div>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-6">
          <label for="username" class="form-label">Usuario <span style="color:red">*</span></label>
          <input type="text" class="form-control" id="username" name="username" minlength="5" required>
        </div>
        <div class="col-md-6">
          <label for="email" class="form-label">Correo Electrónico <span style="color:red">*</span></label>
          <input type="email" class="form-control" id="email" name="email" required>
        </div>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-6">
          <label for="password" class="form-label">Contraseña <span style="color:red">*</span></label>
          <input type="password" class="form-control" id="password" name="password" minlength="8" required>
        </div>
        <div class="col-md-6">
          <label for="confirm_password" class="form-label">Confirmar Contraseña <span style="color:red">*</span></label>
          <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
        </div>
      </div>
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <button class="btn btn-success w-100">Registrarme</button>
    </form>

    <div class="mt-3 text-center">
      ¿Ya tienes cuenta? <a href="{{ url_for('pages_auth.login_page') }}" data-no-swup>Inicia Sesión</a>
    </div>
  </div>
</div>

<script>
  document.querySelector('form').addEventListener('submit', function (e) {
    const pwd = document.getElementById('password').value;
    const cpwd = document.getElementById('confirm_password').value;
    if (pwd !== cpwd) {
      e.preventDefault();
      window.dispatchEvent(new CustomEvent('flash', { 
        detail: { level: 'danger', message: 'Las contraseñas no coinciden' }
      }));
    }
  });
</script>
{% endblock %}